<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>underscore</title>
  <style>
	.container{width:400px;height:400px;margin:0 auto;position:relative;border-radius:50%;box-sizing:border-box;background:white;}
	@-webkit-keyframes xuanzhuan{
		from{transform:rotate(0deg);}
		to{transform:rotate(360deg)}
	}
	.container::before{content:'';position:absolute;left:0;top:0;width:400px;height:400px;background:white;z-index:2;border-radius:50%;border:solid red;border-width:0 0px 0 200px;box-sizing:border-box;transform:rotate(0deg);animation:/* movebefore */ 1s linear forwards;}
	.container::after{content:'';position:absolute;left:0;top:0;width:400px;height:400px;background:transparent;z-index:2;border-radius:50%;border:solid white;border-width:0 200px 0 0px;box-sizing:border-box;transform:rotate(180deg);animation:/* moveafter */ 1s linear forwards;animation-delay:1s;}
	.disc{position:absolute;width:380px;height:380px;left:50%;top:50%;transform:translate(-50%,-50%);background:white;border-radius:50%;z-index:9;}

	.triangle{width:0;height:0;border-top:50px solid red;border-right:50px solid transparent;border-bottom:50px solid transparent;border-left:50px solid transparent;border-radius:50%;}

	@-webkit-keyframes movebefore{
		from{transform:rotate(0deg);}
		to{transform:rotate(180deg);}
	}
	@-webkit-keyframes moveafter{
		0%{
			border-color:transparent;
			transform:rotate(0deg);
		}
		0.1%{
			border-color:red;
		}
		100%{
			border-color:red;
			transform:rotate(180deg);
		}
	}
  </style>
 </head>
 <body>
	<a href="https://qr.alipay.com/bax02628llaekhcg2a7v500b" target="_blank">这是一个支付宝链接</a>
	<div class="triangle"></div>
	<div>
		<div class="container">
			<div class="disc"></div>
		</div>
	</div>
	<input type='range' min='0' max='360' value='0' id="range"/><span id="rate">0</span>
	<div id="app">
		<div>
			<p v-text='name'></p>
			<div v-text="age"></div>
			<input type="text" v-model="age" />
		</div>
	</div>
 </body>
 <script src='./handpaaspay.min.js'></script>
 <script src="https://underscorejs.net/underscore.js"></script>
 <script>
	console.log(HandpaasPay);
	let range = document.getElementById('range');
	range.onchange = function(){
		progress(this.value);
		document.getElementById('rate').innerHTML = this.value;
	}
	function progress(deg){
		let half = deg <= 180 ? true : false;
		if(half){
			document.styleSheets[0].addRule('.container::before',`transform:rotate(${deg}deg)`);
			document.styleSheets[0].addRule('.container::after',`transform:rotate(180deg);border-color:white;`);
		}else{
			document.styleSheets[0].addRule('.container::before',`transform:rotate(180deg)`);
			document.styleSheets[0].addRule('.container::after',`transform:rotate(${deg - 180}deg);border-color:red;`);
		}
	}
	//_.where
	let arr = [{a:1,b:'hehe',c:function(){alert(1)}},{a:2,b:'hehe',c:function(){}},{a:2,b:'he',c:function(){}}];
	let v1 = _.where(arr,{a:1});

	//_.reject
	let arr2 = [1,2,3,4];
	let v2 = _.reject(arr2,(value) => value % 2 === 0);

	//_.contains
	let ar3 = [1,2,3,'c',{a:2}];
	let v3 = _.contains(ar3,'c');
	
	//_.invoke
	let v4 = _.invoke([1,2,4,3],'Math.max'); // x

	//pluck
	let v5 = _.pluck([{name:1,age:21},{name:2,age:22}],'age'); //like map

	//max
	let max = _.max([{age:101},{age:99}],(o) => o.age);
	console.log(max);
	
	let res = _.chain([1,2,3,4,5,6]).filter((num) => num % 2 === 0).map((num) => num * 2).value();

	console.log(_.isEqual({},{}));

	function Promises(execute){
		this.status = 'pending';
		this.value = undefined;
		this.reason = undefined;
		this.onResolved = [];
		this.onRejected = [];
			
		let self = this;
		execute(resolve,reject);
		function resolve(value){
			if(self.status == 'pending'){
				self.value = value;
				self.status = 'resolved';
				self.onResolved.forEach(fn => fn(value));
			}
		}

		function reject(value){
			if(self.status == 'pending'){
				self.value = value;
				self.status = 'rejected';
				self.onRejected.forEach(fn => fn(value));
			}
		}
	}

	Promises.prototype.then = function(resolve,reject){
		setTimeout(()=>{
			if(this.status === 'resolved'){
				resolve(this.value);
			}
			if(this.status === 'rejected'){
				reject(this.value);
			}
			
			if(this.status === 'pending'){
				if(typeof resolve === 'function'){
					this.onResolved.push(resolve);
				}
			}

			if(this.status === 'pending'){
				if(typeof reject === 'function'){
					this.onRejected.push(resolve);
				}
			}
		},0);
	}
	
	new Promises((resolve,reject)=>{
		setTimeout(()=>{
			reject('error');
		},1000);
		
	}).then(res => {
	});


	class Vue{
		constructor(option){
			this.el = document.getElementById(option.el);
			this.data = option.data;
			this.direactive = {};

			this.observe(this.data);
			this.compile(this.el);
		}
		
		observe(data){
			for(let key in data){
				this.direactive[key] = [];
				let oldVal = data[key];
				Object.defineProperty(this.data,key,{
					get:function(){
						return oldVal;
					},
					set:function(newVal){
						if(newVal != oldVal){
							oldVal = newVal;
							this.compile(this.el);
							this.direactive[key].forEach(function(watch){
								watch.update();
							});
						}
					}.bind(this)
				});
			}
			
		}

		compile(el){
			let nodes = el.children;
			for(let i = 0; i < nodes.length; i++){
				let node = nodes[i];
				if(node.children.length){
					this.compile(node);
				}
				if(node.hasAttribute('v-text')){
					let dataVal = node.getAttribute('v-text');
					this.direactive[dataVal].push(new Watcher(this,node,'innerHTML',this.data[dataVal]));
				}
				if(node.hasAttribute('v-model')){
					let self = this,
						dataVal = node.getAttribute('v-model');
					node.value = self.data[dataVal];
					node.addEventListener('input',function(){
						self.data[dataVal] = this.value;
					});
				}
			}
		}
	}
	
	class Watcher{
		constructor(obj,el,attr,val){
			this.el = el;
			this.attr = attr;
			this.val = val;
			this.update();
		}
		update(){
			this.el[this.attr] = this.val;
		}
	}

	new Vue({
		el:'app',
		data:{
			name:'zzs',
			age:29
		}
	});

	//继承
	
	function Animal(){
		
	}
	//1
	function Dog(){
		Animal.call(this,arguments);
	}
	//2 //3
	Dog.prototype = new Animal();
	
	//4
	Dog.prototype = Animal.prototype;
	Dog.prototype.Constructor = Dog;

	//5 
	Dog.prototype = Object.create(Animal.prototype);
	Dog.prototype.Constructor = Dog;

	//new的意义
	function F(){
		let o = {};
		o.__proto__ = F.prototype;
		F.call(o);
		return o;
	}

	//function sum(1,2,3,4,5){} like sum(1)(2);
	function sum(...args){
		return args.reduce(function(sum,cur){
			return sum + cur
		},0)
	}

	function sum(num){
		let init = num;
		function innerSum(num2){
			init += num2;
			return innerSum;
		}
		innerSum.toString = function(){
			return init;
		}
		return innerSum;
	}
	

	let $ = (function(){
		function Jquery(){
			return new Jquery.prototype.init();
		}
		
		Jquery.prototype = Jquery.fn = {
			init:function(){
				this.context = document;
				let selector = document.getElementsByTagName('div');
				[].push.apply(this,selector);
				return this;
			},
			test:function(){
				alert(1)
			}
		}
		Jquery.fn.init.prototype = Jquery.fn;
		return Jquery;
	})();
	
	Array.prototype.myMap = function(fn){
		let self = this;
		return this.reduce(function(prev,cur,i){
			let value = fn.call(this,cur,i);
			return [...prev,value];
		},[]);
	}
	let newarr = [1,2,3].myMap(function(val,i){
		return val * 2;
	});
	
	var gotRandom = function(max,min){
        return Math.random() * (max - min + 1) + min
    }
    var randoms = gotRandom(1,0);
	console.log(randoms);
 </script>
</html>
